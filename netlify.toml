[build]
  command = "npm run build:netlify"
  publish = "out"
  environment:
    SECRETS_SCAN_ENABLED = "false"
    SECRETS_SCAN_OMIT_KEYS = "NEXT_PUBLIC_SUPABASE_URL,NEXT_PUBLIC_SUPABASE_ANON_KEY,NEXT_PUBLIC_HCAPTCHA_SITE_KEY,NEXT_PUBLIC_RECAPTCHA_SITE_KEY,NEXT_PUBLIC_CTA_DESTINATION,NEXT_PUBLIC_ONBOARDING_AUTO_REDIRECT,PLAUSIBLE_DOMAIN"

[functions]
  directory = "netlify/functions"
  node_bundler = "esbuild"

[[redirects]]
  from = "/api/contact"
  to = "/.netlify/functions/contact"
  status = 200

[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/api/:splat"
  status = 200

[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
